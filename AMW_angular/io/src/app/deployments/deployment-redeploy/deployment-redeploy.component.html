<div class="col-sm-10 main-full">
  <div *ngIf="selectedDeployments$ | async as deployments">
    <form *ngIf="deployments.length > 0; else noSelection">
      <div class="form-group row">
        <label class="col-sm-2 font-weight-bold text-right" for="applicationServer">Applicationserver</label>
        <div class="col-sm-10 col-md-5">
          <a href="#" (click)="showAppserverNames(appServerNamesModal); (false)">show selected app server names</a>
        </div>
      </div>
      <div class="form-group row">
        <label class="col-sm-2 font-weight-bold text-right">Environments</label>
        <div class="col-sm-10" *ngIf="groupedEnvironments$ | async as groupedEnvironments">
          <ng-container *ngFor="let groupName of groupedEnvironments.keys()">
            <p class="mb-1">{{ groupName }}:</p>
            <div class="d-inline mr-3" *ngFor="let env of groupedEnvironments.get(groupName)">
              <label
                ><input class="mr-2" type="checkbox" (change)="onChangeEnvironment()" />{{ env.name }}
                <ng-container *ngIf="env.nameAlias">({{ env.nameAlias }})</ng-container>
              </label>
            </div>
          </ng-container>
        </div>
      </div>
      <div class="form-group row">
        <label class="col-sm-2 font-weight-bold text-right" for="deploymentDate">Deploy at</label>

        <div class="col-sm-10 col-md-5">
          <app-date-time-picker name="dateDeployment" id="dateDeployment"></app-date-time-picker>
        </div>
      </div>
      <app-parameter [deploymentParameters]="deploymentParameters" (addParamEvent)="onAddParam($event)"></app-parameter>
      <div class="form-group row">
        <label class="col-sm-2 font-weight-bold text-right" for="details">Details</label>
        <div class="col-sm-10 col-md-5">
          <div>
            <label>
              <input type="checkbox" />
              simulate before deployment
            </label>
          </div>
          <div>
            <label>
              <input type="checkbox" />
              send an email when deployed
            </label>
          </div>
          <div *ngIf="hasPermissionShakedownTest">
            <label>
              <input type="checkbox" />
              execute shakedown tests when deployed
            </label>
          </div>
          <div *ngIf="doExecuteShakedownTest">
            <label>
              <input type="checkbox" />
              test neighbourhood
            </label>
          </div>
        </div>
      </div>
    </form>
    <ng-template #appServerNamesModal let-modal>
      <div class="modal-header">
        <h6 class="modal-title">Selected application servers with applications and releases</h6>
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true" (click)="modal.dismiss()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <app-appserver-displayname
          *ngFor="let deployment of deployments"
          [deployment]="deployment"
        ></app-appserver-displayname>
      </div>
    </ng-template>
  </div>
</div>

<ng-template #noSelection>
  No deployments selected
</ng-template>
